const e=new class{constructor(){this.eventLogs=[],this.suspiciousActivities=[],this.screenshotInterval=null,this.altKeyActive=!1,this.initLockdown(),this.initLogging(),this.enforceFullscreen(),this.startScreenshotCapture(),this.detectWindowSwitching()}showAlert(e){}initLockdown(){document.addEventListener("contextmenu",(e=>{e.preventDefault(),this.logEvent("Right-click blocked")})),document.addEventListener("selectstart",(e=>{e.preventDefault(),this.logEvent("Text selection blocked")})),document.addEventListener("keydown",(e=>{if(e.ctrlKey||e.metaKey){["c","v","x","s","a"].includes(e.key.toLowerCase())&&(e.preventDefault(),this.logEvent(`Blocked shortcut: ${e.key.toUpperCase()}`),this.notifySuspiciousActivity(`Blocked shortcut: ${e.key.toUpperCase()}`))}}))}enforceFullscreen(){console.log("Attempting to enter fullscreen");const e=document.documentElement;e.requestFullscreen?e.requestFullscreen().then((()=>console.log("Fullscreen activated"))).catch((e=>console.error("Failed to activate fullscreen:",e))):e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}handleFullscreenChange(){document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||(this.logEvent("Fullscreen exited"),this.notifySuspiciousActivity("Fullscreen exited"),this.enforceFullscreen())}initLogging(){window.addEventListener("blur",(()=>{this.logEvent("Tab switch or window blur detected"),this.notifySuspiciousActivity("Tab switch detected")})),document.addEventListener("keydown",(e=>{e.altKey&&"Tab"===e.key&&(this.logEvent("Alt+Tab detected"),this.notifySuspiciousActivity("Attempted window/tab switch (Alt+Tab)"))}))}logEvent(e){const t=(new Date).toISOString();this.eventLogs.push({message:e,timestamp:t}),console.log(`[LOG ${t}] ${e}`)}getLogs(){return this.eventLogs}startScreenshotCapture(){this.screenshotInterval=setInterval((()=>{this.captureScreenshot()}),6e5)}captureScreenshot(){navigator.mediaDevices.getDisplayMedia?navigator.mediaDevices.getDisplayMedia({video:!0}).then((e=>{const t=e.getVideoTracks()[0];new ImageCapture(t).grabFrame().then((t=>{const s=document.createElement("canvas");s.width=t.width,s.height=t.height;s.getContext("2d").drawImage(t,0,0,s.width,s.height);const i=s.toDataURL("image/png");this.logEvent("Screenshot captured"),console.log("Captured screenshot as image data:",i),e.getTracks().forEach((e=>e.stop()))})).catch((e=>{this.logEvent("Screenshot capture failed"),console.error("Screenshot capture failed:",e)}))})).catch((e=>{this.logEvent("Screen capture failed"),console.error("Screen capture failed:",e)})):(this.logEvent("Screen capture not supported"),console.error("Screen capture is not supported by this browser"))}notifySuspiciousActivity(e){const t=(new Date).toISOString();this.suspiciousActivities.push({activity:e,timestamp:t}),this.showAlert(`Warning: ${e}`)}saveToSessionStorage(e,t){sessionStorage.setItem(e,JSON.stringify(t))}detectWindowSwitching(){document.addEventListener("keydown",(e=>{"Alt"===e.key?this.altKeyActive=!0:this.altKeyActive&&"Tab"===e.key?(this.logEvent("Alt+Tab detected"),this.notifySuspiciousActivity("Attempted window switch (Alt+Tab)")):"Meta"===e.key&&(this.logEvent("Meta key pressed"),this.notifySuspiciousActivity("Attempted window switch (Windows/Meta key)"))})),document.addEventListener("keyup",(e=>{"Alt"===e.key&&(this.altKeyActive=!1)})),window.addEventListener("blur",(()=>{this.logEvent("Window blur detected (potential tab switch)"),this.notifySuspiciousActivity("Tab or window switch detected")}))}generateSessionSummary(){const e={totalEvents:this.eventLogs.length,suspiciousActivities:this.suspiciousActivities,eventLog:this.eventLogs};return console.table(e),e}endSession(){clearInterval(this.screenshotInterval);const e=this.generateSessionSummary();return this.logEvent("Session ended"),e}};export{e as default};
